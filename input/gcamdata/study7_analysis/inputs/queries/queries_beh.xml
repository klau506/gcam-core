<?xml version="1.0" encoding="UTF-8"?>
<queries>

   <aQuery>
      <all-regions />
            <emissionsQueryBuilder title="nonCO2 emissions by region">
                <axis1 name="GHG">GHG</axis1>
                <axis2 name="Year">emissions</axis2>
                <xPath buildList="true" dataName="emissions" group="false" sumAll="false">*[@type = 'sector' (:collapse:) or @type = 'resource' (:collapse:)](: / *[@type = 'subresource' (: collapse :)] :)//
            *[@type = 'GHG' and @name != 'CO2' and @name != 'CO2_FUG']/emissions/node()</xPath>
				<labelRewriteList append-values="false">
                    <level name="GHG">
                        <rewrite from="CO2_FUG" to="CO2"/>
                    </level>
                </labelRewriteList>
                <comments/>
            </emissionsQueryBuilder>
   </aQuery>
   <aQuery>
      <all-regions />
      <emissionsQueryBuilder title="International Aviation emissions">
         <axis1 name="subsector">subsector</axis1>
         <axis2 name="Year">emissions</axis2>
         <xPath buildList="true" dataName="emissions" group="false" sumAll="false">*[@type = 'sector' ]/*[@type = 'subsector' and (@name='International Aviation')]//*[@type = 'GHG']/emissions/node()</xPath>
         <comments>This query will not include resource emissions</comments>
      </emissionsQueryBuilder>
   </aQuery>
   <aQuery>
      <all-regions />
      <emissionsQueryBuilder title="International Shipping emissions">
         <axis1 name="subsector">subsector</axis1>
         <axis2 name="Year">emissions</axis2>
         <xPath buildList="true" dataName="emissions" group="false" sumAll="false">*[@type = 'sector' ]/*[@type = 'subsector' and (@name='International Ship')]//*[@type = 'GHG']/emissions/node()</xPath>
         <comments>This query will not include resource emissions</comments>
      </emissionsQueryBuilder>
   </aQuery>
   <aQuery>
      <all-regions />
            <query title="LUC emissions by region">
                <axis1 name="LandLeaf">LandLeaf</axis1>
                <axis2 name="Year">land-use-change-emission[@year]</axis2>
                <xPath buildList="true" dataName="land-use-change-emission" group="false" sumAll="true">/LandNode[@name='root' or @type='LandNode' (:collapse:)]//
                land-use-change-emission[@year&gt;1970]/text()</xPath>
                <comments/>
            </query>
   </aQuery>
   <aQuery>
      <all-regions />
            <emissionsQueryBuilder title="CO2 emissions by region">
                <axis1 name="region">region</axis1>
                <axis2 name="Year">emissions</axis2>
                <xPath buildList="true" dataName="emissions" group="false" sumAll="false">*[@type = 'sector' (:collapse:) or @type = 'resource' (:collapse:)](: / *[@type = 'subresource' (: collapse :)] :)//*[((@name='CO2' or @name = 'CO2_FUG'))]/emissions/node()</xPath>
                <comments/>
            </emissionsQueryBuilder>
   </aQuery>
   <aQuery>
      <all-regions />
      <emissionsQueryBuilder title="nonCO2 emissions by resource production">
         <axis1 name="GHG">GHG</axis1>
         <axis2 name="Year">emissions</axis2>
         <xPath buildList="true" dataName="emissions" group="false" sumAll="false">*[@type = 'resource']//*[@type = 'GHG']/emissions/node()</xPath>
         <comments />
      </emissionsQueryBuilder>
   </aQuery>


   <aQuery>
      <all-regions />
      <supplyDemandQuery title="ag production by crop type">
         <axis1 name="sector">sector[@name]</axis1>
         <axis2 name="Year">physical-output[@vintage]</axis2>
         <xPath buildList="true" dataName="output" group="false" sumAll="false">*[@type='sector' and (local-name()='AgSupplySector')]//
            output-primary/physical-output/node()</xPath>
         <comments>primary output only (no residue biomass)</comments>
      </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
               <supplyDemandQuery title="ag production by subsector (land use region)">
                    <axis1 name="technology">technology[@name]</axis1>
                    <axis2 name="Year">physical-output[@vintage]</axis2>
                    <xPath buildList="true" dataName="output" group="false" sumAll="false">*[@type='sector' and (local-name()='AgSupplySector')]/
            *[@type='subsector']//output-primary/physical-output/node()</xPath>
                    <comments>primary output only (no residue biomass)</comments>
                </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
      <supplyDemandQuery title="ag import vs. domestic prices">
         <axis1 name="subsector">subsector</axis1>
         <axis2 name="Year">cost</axis2>
         <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector' and contains(@name, 'regional')]/*[@type='subsector']/cost[@unit='1975$/kg' or @unit='1975$/m3']/text()</xPath>
         <comments />
      </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
      <supplyDemandQuery title="ag regional prices (weighted average b/t domestic and imported prices)">
         <axis1 name="sector">sector</axis1>
         <axis2 name="Year">cost</axis2>
         <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector' and contains(@name, 'regional')]/cost[@unit='1975$/kg' or @unit='1975$/m3']/text()</xPath>
         <comments />
      </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
      <supplyDemandQuery title="ag import vs. domestic supply (Regional Armington competition)">
         <axis1 name="input">input</axis1>
         <axis2 name="Year">demand-physical[@vintage]</axis2>
         <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector' and contains(@name, 'regional')]/*[@type='subsector']//*[@type='input']/demand-physical[@unit='Mt' or @unit='billion m3']/node()</xPath>
         <comments />
      </supplyDemandQuery>
   </aQuery>


   <aQuery>
      <all-regions />
      <supplyDemandQuery title="food consumption by type (specific)">
         <axis1 name="technology">technology</axis1>
         <axis2 name="Year">physical-output[@vintage]</axis2>
         <xPath buildList="true" dataName="output" group="false" sumAll="false">*[@type='sector' (:collapse:) and (@name='FoodDemand_Staples' or @name='FoodDemand_NonStaples')]//
            *[@type='subsector']//*[@type='technology']/
            *[@type='output' (:collapse:)]/physical-output/node()</xPath>
         <comments />
      </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
            <supplyDemandQuery title="food consumption by type (general)">
                <axis1 name="sector">sector</axis1>
                <axis2 name="Year">physical-output[@vintage]</axis2>
                <xPath buildList="true" dataName="output" group="false" sumAll="false">*[@type='sector' and (@name='FoodDemand_Staples' or @name='FoodDemand_NonStaples')]//
            *[@type='output']/physical-output/node()</xPath>
                <comments/>
            </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
      <supplyDemandQuery title="food demand">
         <axis1 name="input">input[@name]</axis1>
         <axis2 name="Year">demand-physical[@vintage]</axis2>
         <xPath buildList="true" dataName="demand" group="false" sumAll="false">gcam-consumer[@name='FoodDemand']//*[@type='input']/demand-physical/node()</xPath>
         <comments />
      </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
      <supplyDemandQuery title="food demand prices">
         <axis1 name="input">input[@name]</axis1>
         <axis2 name="Year">price-paid[@vintage]</axis2>
         <xPath buildList="true" dataName="price" group="false" sumAll="false">gcam-consumer[@name='FoodDemand']//*[@type='input']/price-paid/node()</xPath>
         <comments />
      </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
                <supplyDemandQuery title="meat and dairy prices">
                    <axis1 name="sector">sector</axis1>
                    <axis2 name="Year">cost</axis2>
                    <xPath buildList="true" dataName="output" group="false" sumAll="false">*[@type='sector' and
               (@name='Beef' or @name='SheepGoat' or @name='Pork' or @name='Dairy' or @name='Poultry')]/
               cost/text()</xPath>
                    <comments/>
                </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
      <supplyDemandQuery title="meat and dairy production by tech">
         <axis1 name="sector">sector</axis1>
         <axis2 name="Year">physical-output[@vintage]</axis2>
         <xPath buildList="true" dataName="output" group="false" sumAll="false">*[@type='sector' and
               (@name='Beef' or @name='SheepGoat' or @name='Pork' or @name='Dairy' or @name='Poultry')]/
               *[@type='subsector']/*[@type='technology']//
               *[@type='output']/physical-output/node()</xPath>
         <comments />
      </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
                <supplyDemandQuery title="meat and dairy production by type">
                    <axis1 name="sector">sector</axis1>
                    <axis2 name="Year">physical-output[@vintage]</axis2>
                    <xPath buildList="true" dataName="output" group="false" sumAll="false">*[@type='sector' and
               (@name='Beef' or @name='SheepGoat' or @name='Pork' or @name='Dairy' or @name='Poultry')]//
               *[@type='output']/physical-output/node()</xPath>
                    <comments/>
                </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
            <supplyDemandQuery title="demand balances by crop commodity">
                <axis1 name="sector">sector</axis1>
                <axis2 name="Year">demand-physical[@vintage]</axis2>
                <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector']//*[@type='input' and
            (@name='regional corn' or @name='regional fibercrop' or @name='regional fruits' or @name='regional legumes'
               or @name='regional misccrop' or @name='regional nuts_seeds' or @name='regional oilcrop' or @name='regional othergrain'
               or @name='regional oilpalm' or @name='regional rice' or @name='regional root_tuber'
               or @name='regional soybean' or @name='regional sugarcrop' or @name='regional vegetables' or @name='regional wheat'
               or @name='FodderGrass' or @name='FodderHerb' or @name='Forest' or @name='Pasture')]/
               demand-physical/node()</xPath>
                <comments/>
            </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
            <supplyDemandQuery title="demand balances by meat and dairy commodity">
                <axis1 name="sector">sector</axis1>
                <axis2 name="Year">demand-physical[@vintage]</axis2>
                <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector']//*[@type='input' and
            (@name='regional beef' or @name='regional dairy' or @name='regional pork' or @name='regional poultry' or @name='regional sheepgoat' or @name='OtherMeat_Fish')]/
            demand-physical/node()</xPath>
                <comments/>
            </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
                <supplyDemandQuery title="feed consumption by region">
                    <axis1 name="region">region</axis1>
                    <axis2 name="Year">demand-physical[@vintage]</axis2>
                    <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector' (:collapse:) and
               (@name='Beef' or @name='SheepGoat' or @name='Pork' or @name='Dairy' or @name='Poultry' )]//
               *[@type='input' and not(@name='renewable') and not(contains(@name,'water_td'))]/
               demand-physical/node()</xPath>
                    <comments/>
                </supplyDemandQuery>
  </aQuery>

   <aQuery>
      <all-regions />
      <marketQuery title="prices of all markets">
         <axis1 name="market">market</axis1>
         <axis2 name="Year">market</axis2>
         <xPath buildList="true" dataName="price" group="false" sumAll="false">Marketplace/market[true()]/price/node()</xPath>
         <comments />
      </marketQuery>
   </aQuery>
   <aQuery>
      <all-regions />
      <supplyDemandQuery title="Ag Commodity Prices">
         <axis1 name="sector">sector</axis1>
         <axis2 name="Year">cost</axis2>
         <xPath buildList="true" dataName="yield" group="false" sumAll="false">*[@type='sector' and
            (exists(child::keyword/@supplysector) or local-name() =
            'AgSupplySector')]/cost/text()</xPath>
         <comments />
      </supplyDemandQuery>
   </aQuery>


   <aQuery>
      <all-regions />
	  <supplyDemandQuery title="biophysical water demand by ag tech">
              <axis1 name="sector">sector</axis1>
              <axis2 name="Year">demand-physical[@vintage]</axis2>
              <xPath buildList="true" dataName="input" group="false" sumAll="false">AgSupplySector/*[@type='subsector']/*[@type='technology']/
               *[@type='input' and (@name='biophysical water consumption')]/demand-physical/node()</xPath>
              <comments/>
        </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
                <supplyDemandQuery title="irrigation water consumption by ag tech">
                    <axis1 name="sector">sector</axis1>
                    <axis2 name="Year">demand-physical[@vintage]</axis2>
                    <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector' and not(contains(@name, 'water_td_irr'))]/*[@type='subsector']/*[@type='technology']/
               *[@type='input' and contains(@name, 'water_td_irr') and ends-with(@name, '_C')]/
               demand-physical/node()</xPath>
                    <comments/>
                </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
                <supplyDemandQuery title="irrigation water withdrawals by region">
                    <axis1 name="region">region</axis1>
                    <axis2 name="Year">demand-physical[@vintage]</axis2>
                    <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector' (:collapse:) and not(contains(@name, 'water_td_irr')) ]//
               *[@type='input' (:collapse:) and contains(@name, 'water_td_irr') and ends-with(@name, '_W')]/
               demand-physical/node()</xPath>
                    <comments/>
                </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
                <supplyDemandQuery title="irrigation water withdrawals by crop type">
                    <axis1 name="sector">sector</axis1>
                    <axis2 name="Year">demand-physical[@vintage]</axis2>
                    <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector' and not(contains(@name, 'water_td_irr'))]//*[@type='input' (:collapse:) and contains(@name, 'water_td_irr') and ends-with(@name, '_W')]/
               demand-physical/node()</xPath>
                    <comments/>
                </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
      <supplyDemandQuery title="water consumption by meat and dairy production">
         <axis1 name="sector">sector</axis1>
         <axis2 name="Year">demand-physical[@vintage]</axis2>
         <xPath buildList="true" dataName="output" group="false" sumAll="false">*[@type='sector']//
               *[@type='input' and contains(@name,'water_td_an') and ends-with(@name,'_C')]/
               demand-physical/node()</xPath>
         <comments />
      </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
      <supplyDemandQuery title="water consumption by subsector">
         <axis1 name="subsector">subsector</axis1>
         <axis2 name="Year">demand-physical[@vintage]</axis2>
         <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector' and not(contains(@name, 'water_td'))]/*[@type='subsector']//*[@type='input' (:collapse:) and contains(@name,'water_td')
         and ends-with(@name,'_C')]/demand-physical/node()</xPath>
         <comments />
         <labelRewriteList append-values="false">
            <level name="sector">
               <rewrite from="elec_Gen_III" to="electricity" />
               <rewrite from="elec_CSP_storage" to="electricity" />
               <rewrite from="elec_refined liquids (steam/CT)" to="electricity" />
               <rewrite from="elec_geothermal" to="electricity" />
               <rewrite from="elec_refined liquids (CC)" to="electricity" />
               <rewrite from="elec_Gen_II_LWR" to="electricity" />
               <rewrite from="elec_gas (steam/CT)" to="electricity" />
               <rewrite from="elec_coal (IGCC)" to="electricity" />
               <rewrite from="elec_gas (CC)" to="electricity" />
               <rewrite from="elec_biomass (IGCC)" to="electricity" />
               <rewrite from="elec_coal (conv pul)" to="electricity" />
               <rewrite from="elec_CSP" to="electricity" />
               <rewrite from="elec_biomass (conv)" to="electricity" />
            </level>
            <level name="subsector">
               <rewrite from="gas (CC)" to="gas" />
               <rewrite from="CSP" to="solar" />
               <rewrite from="biomass (conv)" to="biomass" />
               <rewrite from="Gen_II_LWR" to="nuclear" />
               <rewrite from="coal (conv pul)" to="coal" />
               <rewrite from="coal (IGCC)" to="coal" />
               <rewrite from="gas (steam/CT)" to="gas" />
               <rewrite from="CSP_storage" to="solar" />
               <rewrite from="biomass (IGCC)" to="biomass" />
               <rewrite from="Gen_III" to="nuclear" />
               <rewrite from="refined liquids (CC)" to="refined liquids" />
               <rewrite from="geothermal" to="geothermal" />
               <rewrite from="refined liquids (steam/CT)" to="refined liquids" />
            </level>
         </labelRewriteList>
      </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
        <supplyDemandQuery title="water withdrawals by region">
            <axis1 name="region">region</axis1>
            <axis2 name="Year">demand-physical[@vintage]</axis2>
            <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector' (:collapse:) and not(contains(@name, 'water_td'))]//*[@type='input' (:collapse:) and contains(@name,'water_td')
         and ends-with(@name,'_W')]/demand-physical/node()</xPath>
            <comments/>
        </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
        <resourceQuery title="Water Withdrawals by Basin (Runoff)">
            <axis1 name="Runoff water">resource[@name]</axis1>
            <axis2 name="Year">production[@year]</axis2>
            <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type = 'resource' and contains(@name, 'water withdrawals')]/*[@type = 'subresource' and contains(@name, 'runoff')]/production/node()</xPath>
            <comments/>
        </resourceQuery>
   </aQuery>
   <aQuery>
      <all-regions />
        <resourceQuery title="Water Withdrawals by Basin (Groundwater)">
            <axis1 name="Groundwater">resource[@name]</axis1>
            <axis2 name="Year">production[@year]</axis2>
            <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type = 'resource' and contains(@name, 'water withdrawals')]/*[@type = 'subresource' and contains(@name, 'groundwater')]/production/node()</xPath>
            <comments/>
        </resourceQuery>
   </aQuery>
   <aQuery>
      <all-regions />
        <supplyDemandQuery title="water withdrawals by subsector">
            <axis1 name="subsector">subsector</axis1>
            <axis2 name="Year">demand-physical[@vintage]</axis2>
            <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector' and not(contains(@name, 'water_td'))]/*[@type='subsector']//*[@type='input' (:collapse:)
         and contains(@name,'water_td') and ends-with(@name,'_W')]/demand-physical/node()</xPath>
            <comments/>
            <labelRewriteList append-values="false">
                <level name="sector">
                    <rewrite from="elec_Gen_III" to="electricity"/>
                    <rewrite from="elec_CSP_storage" to="electricity"/>
                    <rewrite from="elec_refined liquids (steam/CT)" to="electricity"/>
                    <rewrite from="elec_geothermal" to="electricity"/>
                    <rewrite from="elec_refined liquids (CC)" to="electricity"/>
                    <rewrite from="elec_Gen_II_LWR" to="electricity"/>
                    <rewrite from="elec_gas (steam/CT)" to="electricity"/>
                    <rewrite from="elec_coal (IGCC)" to="electricity"/>
                    <rewrite from="elec_gas (CC)" to="electricity"/>
                    <rewrite from="elec_biomass (IGCC)" to="electricity"/>
                    <rewrite from="elec_coal (conv pul)" to="electricity"/>
                    <rewrite from="elec_CSP" to="electricity"/>
                    <rewrite from="elec_biomass (conv)" to="electricity"/>
                </level>
                <level name="subsector">
                    <rewrite from="gas (CC)" to="gas"/>
                    <rewrite from="CSP" to="solar"/>
                    <rewrite from="biomass (conv)" to="biomass"/>
                    <rewrite from="Gen_II_LWR" to="nuclear"/>
                    <rewrite from="coal (conv pul)" to="coal"/>
                    <rewrite from="coal (IGCC)" to="coal"/>
                    <rewrite from="gas (steam/CT)" to="gas"/>
                    <rewrite from="CSP_storage" to="solar"/>
                    <rewrite from="biomass (IGCC)" to="biomass"/>
                    <rewrite from="Gen_III" to="nuclear"/>
                    <rewrite from="refined liquids (CC)" to="refined liquids"/>
                    <rewrite from="geothermal" to="geothermal"/>
                    <rewrite from="refined liquids (steam/CT)" to="refined liquids"/>
                </level>
            </labelRewriteList>
        </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
                <supplyDemandQuery title="water consumption by meat and dairy production">
                    <axis1 name="sector">sector</axis1>
                    <axis2 name="Year">demand-physical[@vintage]</axis2>
                    <xPath buildList="true" dataName="output" group="false" sumAll="false">*[@type='sector']//
               *[@type='input' and contains(@name,'water_td_an') and ends-with(@name,'_C')]/
               demand-physical/node()</xPath>
                    <comments/>
                </supplyDemandQuery>
   </aQuery>


   <aQuery>
      <all-regions />
            <supplyDemandQuery title="purpose-grown biomass production">
                <axis1 name="sector">sector[@name]</axis1>
                <axis2 name="Year">physical-output[@vintage]</axis2>
                <xPath buildList="false" dataName="output" group="false" sumAll="false">*[@type='sector' and (@name='biomass')]//*[@type='output' (:collapse:)]/
            physical-output/node()</xPath>
                <comments/>
            </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
            <resourceQuery title="MSW production">
                <axis1 name="resource">resource</axis1>
                <axis2 name="Year">output</axis2>
                <xPath buildList="false" dataName="production" group="false" sumAll="false">*[@type='resource' and (@name='biomass')]//output/node()</xPath>
                <comments/>
            </resourceQuery>
   </aQuery>
   <aQuery>
      <all-regions />
            <supplyDemandQuery title="regional biomass consumption">
                <axis1 name="sector">sector</axis1>
                <axis2 name="Year">demand-physical[@vintage]</axis2>
                <xPath buildList="false" dataName="input" group="false" sumAll="false">*[@type='sector' and (@name='regional biomass')]//*[@type='input']/
            demand-physical/node()</xPath>
                <comments/>
            </supplyDemandQuery>
   </aQuery>
   <aQuery>
      <all-regions />
            <supplyDemandQuery title="residue biomass production">
                <axis1 name="sector">sector[@name]</axis1>
                <axis2 name="Year">physical-output[@vintage]</axis2>
                <xPath buildList="false" dataName="output" group="false" sumAll="false">*[@type='sector' and not(@name='biomass')]//*[@type='output' and @name='biomass']/physical-output/node()</xPath>
                <comments/>
            </supplyDemandQuery>
   </aQuery>


   <aQuery>
      <all-regions />
            <query title="aggregated land allocation">
                <axis1 name="LandLeaf">LandLeaf[@crop]</axis1>
                <axis2 name="Year">land-allocation[@year]</axis2>
                <xPath buildList="true" dataName="LandLeaf" group="false" sumAll="false">/LandNode[@name='root' or @type='LandNode' (:collapse:)]//land-allocation/text()</xPath>
                <comments/>
                <labelRewriteList append-values="false">
                    <level name="LandLeaf">
                        <rewrite from="Grassland" to="grass"/>
                        <rewrite from="ProtectedUnmanagedPasture" to="pasture (other)"/>
                        <rewrite from="Vegetables" to="crops"/>
                        <rewrite from="FodderHerb" to="crops"/>
                        <rewrite from="MiscCrop" to="crops"/>
                        <rewrite from="OtherGrainC4" to="crops"/>
                        <rewrite from="PalmFruit" to="crops"/>
                        <rewrite from="FiberCrop" to="crops"/>
                        <rewrite from="NutsSeeds" to="crops"/>
                        <rewrite from="OtherGrain" to="crops"/>
                        <rewrite from="Soybean" to="crops"/>
                        <rewrite from="FodderGrass" to="crops"/>
                        <rewrite from="ProtectedGrassland" to="grass"/>
                        <rewrite from="Fruits" to="crops"/>
                        <rewrite from="FodderHerbC4" to="crops"/>
                        <rewrite from="ProtectedUnmanagedForest" to="forest (unmanaged)"/>
                        <rewrite from="biomassTree" to="biomass"/>
                        <rewrite from="OilPalm" to="crops"/>
                        <rewrite from="OtherArableLand" to="otherarable"/>
                        <rewrite from="MiscCropTree" to="crops"/>
                        <rewrite from="OilPalmTree" to="crops"/>
                        <rewrite from="Rice" to="crops"/>
                        <rewrite from="Legumes" to="crops"/>
                        <rewrite from="NutsSeedsTree" to="crops"/>
                        <rewrite from="OilCropTree" to="crops"/>
                        <rewrite from="UrbanLand" to="urban"/>
                        <rewrite from="RockIceDesert" to="rock and desert"/>
                        <rewrite from="RootTuber" to="crops"/>
                        <rewrite from="Corn" to="crops"/>
                        <rewrite from="FruitsTree" to="crops"/>
                        <rewrite from="OilCrop" to="crops"/>
                        <rewrite from="ProtectedShrubland" to="shrubs"/>
                        <rewrite from="SugarCrop" to="crops"/>
                        <rewrite from="UnmanagedForest" to="forest (unmanaged)"/>
                        <rewrite from="SugarCropC4" to="crops"/>
                        <rewrite from="Pasture" to="pasture (grazed)"/>
                        <rewrite from="Forest" to="forest (managed)"/>
                        <rewrite from="biomassGrass" to="biomass"/>
                        <rewrite from="Shrubland" to="shrubs"/>
                        <rewrite from="UnmanagedPasture" to="pasture (other)"/>
                        <rewrite from="Tundra" to="tundra"/>
                        <rewrite from="Wheat" to="crops"/>
                        <rewrite from="CornC4" to="crops"/>
                    </level>
                </labelRewriteList>
            </query>
   </aQuery>
   <aQuery>
      <all-regions />
            <query title="land allocation by crop and water source">
                <axis1 name="water">water[@name]</axis1>
                <axis2 name="Year">land-allocation[@year]</axis2>
                <xPath buildList="true" dataName="LandLeaf" group="false" sumAll="false"><![CDATA[
                     
            declare function local:nest-land-category($leaf as node(), $level as xs:string, $child as node()*) as node() {
                let $attrMatch := $leaf/@*[name()=$level],
                    $attrValue := if(exists($attrMatch)) then string($attrMatch) else "NA"
                return element { $level } {
                    attribute name { $attrValue },
                    $child
                }
            };
            declare function local:run-nest-land-categories($scenarios as xs:string*, $regions as xs:string*, $collection as xs:string) as node()* { 	
                let $regionsG := if(not($regions[1] = 'Global'))
                                 then $regions
                                 else distinct-values(collection($collection)/scenario/world/*[@type='region']/@name)
                return
                    for $scenario in $scenarios, 	    
                        $region in $regionsG 	
                    let $scenario_split := tokenize($scenario, ' '), 	    
                        $currTree := collection($collection)/scenario[@name = $scenario_split[1] and @date = $scenario_split[2]]/world/*[@type='region' and @name=$region],
                        $landLeaves := $currTree//LandNode[@name='root' or @type='LandNode' (:collapse:)]//LandLeaf,
                        $ret := document {
                            element scenario {
                                attribute name { $scenario_split[1] },
                                attribute date { $scenario_split[2] },
                                element region {
                                    attribute type { "region" },
                                    attribute name { $region },
                                    for $leaf in $landLeaves
                                    (: TODO: not sure why I have to explicitly copy the land-allocation :)
                                    let $copy := for $landAlloc in $leaf/land-allocation
                                                 return element land-allocation {
                                                    $landAlloc/@*,
                                                    text { $landAlloc/text() }
                                                 }
                                    (: A user could choose to nest by recursively calling for any of: ("crop", "land-region", "water", "mgmt-tech") :)
                                    return local:nest-land-category($leaf, "crop", local:nest-land-category($leaf, "water", $copy))
                                }
                            }
                        }
                    return $ret//text()
            };
            local:run-nest-land-categories((:scenarios:), (:regions:), (:collection:))
            
            
                ]]></xPath>
                <comments/>
            </query>
   </aQuery>
   <aQuery>
      <all-regions />
            <query title="land allocation by crop">
                <axis1 name="LandLeaf">LandLeaf[@crop]</axis1>
                <axis2 name="Year">land-allocation[@year]</axis2>
                <xPath buildList="true" dataName="LandLeaf" group="false" sumAll="false">/LandNode[@name='root' or @type='LandNode' (:collapse:)]//land-allocation/text()</xPath>
                <comments/>
            </query>
   </aQuery>
   <aQuery>
      <all-regions />
            <query title="vegetative carbon stock by region">
                <axis1 name="LandLeaf">LandLeaf</axis1>
                <axis2 name="Year">above-ground-carbon-stock[@year]</axis2>
                <xPath buildList="true" dataName="above-ground-carbon-stock" group="false" sumAll="true">/LandNode[@name='root' or @type='LandNode' (:collapse:)]//
                above-ground-carbon-stock[@year&gt;1970]/text()</xPath>
                <comments/>
            </query>
   </aQuery>
   <aQuery>
      <all-regions />
                <supplyDemandQuery title="fertilizer consumption by crop type">
                    <axis1 name="sector">sector</axis1>
                    <axis2 name="Year">demand-physical[@vintage]</axis2>
                    <xPath buildList="true" dataName="input" group="false" sumAll="false">*[@type='sector' and not (@name='Exports_N fertilizer')]//
               *[@type='input' and (@name='N fertilizer')]/demand-physical/node()</xPath>
                    <comments/>
                </supplyDemandQuery>
   </aQuery>


   <aQuery>
      <all-regions />
        <demographicsQuery title="population by region">
            <axis1 name="region">region</axis1>
            <axis2 name="Year">populationMiniCAM</axis2>
            <xPath buildList="true" dataName="total-population" group="false" sumAll="false">demographics/populationMiniCAM/total-population/node()</xPath>
            <comments/>
        </demographicsQuery>
  </aQuery>
   <aQuery>
      <all-regions />
        <gdpQueryBuilder title="GDP per capita PPP by region">
            <axis1 name="region">region</axis1>
            <axis2 name="Year">nationalAccount[@year]</axis2>
            <xPath buildList="true" dataName="gdp-per-capita-ppp" group="false" sumAll="false">nationalAccount/account[@name = 'gdp-per-capita-ppp']/node()</xPath>
            <comments/>
        </gdpQueryBuilder>
  </aQuery>


   <aQuery>
      <all-regions />
                <supplyDemandQuery title="refined liquids production by tech">
                    <axis1 name="technology">technology</axis1>
                    <axis2 name="Year">physical-output[@vintage]</axis2>
                    <xPath buildList="true" dataName="output" group="false" sumAll="false">*[@type='sector' and 
               (@name='oil refining' or @name='biomass liquids' or @name='gas to liquids' or @name='coal to liquids')]/*[@type='subsector']/
               *[@type='technology']/output-primary[@type='output' (:collapse:)]/physical-output/node()</xPath>
                    <comments/>
                </supplyDemandQuery>
  </aQuery>
   <aQuery>
      <all-regions />
            <supplyDemandQuery title="outputs by tech">
                <axis1 name="technology">technology[@name]</axis1>
                <axis2 name="Year">physical-output[@vintage]</axis2>
                <xPath buildList="true" dataName="output" group="false" sumAll="false">*[@type='sector']/*[@type='subsector']/*[@type='technology']/*[@type='output']/physical-output/node()</xPath>
                <comments/>
            </supplyDemandQuery>
  </aQuery>
</queries>